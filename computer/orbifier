#!/usr/bin/env ruby

$LOAD_PATH << './app'
$LOAD_PATH << './lib'

require 'argument_parser'
require 'parser'
require 'weather_parser'
require 'delay_parser'
require 'orb'

options = ArgumentParser.parse(ARGV)

parser = case options[:parser]
  when "weather" then WeatherParser.new(options[:city])
  when "delay" then DelayParser.new(options[:origin], options[:destination])
end

orb = Orb.new(options[:port])
parser.green? ? orb.green(:on) : orb.green(:off)
orb.close # Will reset Arduino
